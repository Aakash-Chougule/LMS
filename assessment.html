<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LMS - Assessment</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: #f8f9fa; }
    nav { background: #2c3e50; color: #fff; display: flex; justify-content: space-between; align-items: center; padding: 15px 40px; }
    nav .logo { font-size: 20px; font-weight: bold; }
    nav .user { font-size: 16px; font-weight: bold; }
    nav ul { list-style: none; display: flex; gap: 20px; margin: 0; padding: 0; }
    nav ul li a { color: #fff; text-decoration: none; font-weight: bold; }
    nav ul li a:hover { color: #1abc9c; }
    .quiz-container { max-width: 700px; margin: 40px auto; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; }
    h1 { margin-bottom: 20px; }
    .question { margin-bottom: 20px; text-align: left; }
    button { padding: 12px 20px; border: none; border-radius: 6px; background: #1abc9c; color: #fff; cursor: pointer; margin: 10px; }
    button:hover { background: #16a085; }
    #result { margin-top: 20px; font-size: 18px; font-weight: bold; }
    
    /* Certificate Preview Styling */
    #certificatePreview {
      margin-top: 30px;
      display: none;
      border: 5px solid #2c3e50;
      padding: 40px;
      text-align: center;
      background: #fffdf5;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    #certificatePreview h2 {
      font-size: 28px;
      margin-bottom: 10px;
      color: #2c3e50;
      text-transform: uppercase;
      border-bottom: 2px solid #ccc;
      display: inline-block;
      padding-bottom: 5px;
    }
    #certificatePreview h3 {
      font-size: 22px;
      margin: 15px 0;
      color: #1a5276;
    }
    #certificatePreview p {
      font-size: 18px;
      margin: 8px 0;
    }
    #certificatePreview .footer {
      margin-top: 30px;
      font-style: italic;
      color: #555;
    }
  </style>
</head>
<body>
  <nav>
    <div class="logo">LMS Assessment</div>
    <ul>
      <li><a href="index.html">üè† Home</a></li>
      <li><a href="leaderboard.html">üèÜ Leaderboard</a></li>
    </ul>
    <div class="user" id="studentName">Welcome, Student</div>
  </nav>

  <div class="quiz-container">
    <h1>Assessment</h1>

    <div id="quiz">
      <div class="question">
        <p>Q1: HTML stands for?</p>
        <input type="radio" name="q1" value="a"> Hyper Text Markup Language<br>
        <input type="radio" name="q1" value="b"> High Tech Machine Learning<br>
      </div>
      <div class="question">
        <p>Q2: Which tag is used for JavaScript?</p>
        <input type="radio" name="q2" value="a"> &lt;js&gt;<br>
        <input type="radio" name="q2" value="b"> &lt;script&gt;<br>
      </div>
      <button onclick="submitQuiz()">Submit</button>
    </div>

    <p id="result"></p>
    <button onclick="previewCertificate()" id="previewBtn" style="display:none;">Preview Certificate</button>
    <button onclick="downloadCertificate()" id="certBtn" style="display:none;">Download Certificate</button>

    <div id="certificatePreview"></div>
  </div>

  <script>
    const studentName = localStorage.getItem("studentName") || "Student";
    const courseName = localStorage.getItem("selectedCourse") || "Course";
    document.getElementById("studentName").textContent = "Welcome, " + studentName;

    let score = 0;

    function submitQuiz() {
      score = 0;
      if (document.querySelector('input[name="q1"]:checked')?.value === "a") score++;
      if (document.querySelector('input[name="q2"]:checked')?.value === "b") score++;

      // Show congratulation message
      document.getElementById("quiz").style.display = "none";
      document.getElementById("result").textContent =
        "üéâ Congratulations " + studentName + "! You successfully completed the course: " + courseName + " with a score of " + score + "/2";

      // Show buttons
      document.getElementById("previewBtn").style.display = "inline-block";
      document.getElementById("certBtn").style.display = "inline-block";

      // Save result to leaderboard
      let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
      leaderboard.push({ name: studentName, score: score, course: courseName });
      localStorage.setItem("leaderboard", JSON.stringify(leaderboard));
    }

    function previewCertificate() {
      let preview = document.getElementById("certificatePreview");
      preview.style.display = "block";
      preview.innerHTML = `
        <h2>Certificate of Completion</h2>
        <p>This is to certify that</p>
        <h3>${studentName}</h3>
        <p>has successfully completed the course:</p>
        <h3>${courseName}</h3>
        <p>with a score of <b>${score}/2</b></p>
        <div class="footer">Date: ${new Date().toLocaleDateString()}<br>Learning Management System</div>
      `;
    }

    async function downloadCertificate() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(22);
      
      doc.text("Certificate of Completion", 60, 40);

      doc.setFontSize(16);
      doc.text("This is to certify that", 20, 70);
      doc.setFontSize(20);
      doc.text(studentName, 20, 90);
      doc.setFontSize(16);
      doc.text("has successfully completed the course:", 20, 110);
      doc.text(courseName, 20, 130);
      doc.text("with a score of " + score + "/2", 20, 150);

      doc.setFontSize(12);
      doc.text("Date: " + new Date().toLocaleDateString(), 20, 170);
      doc.text("Learning Management System", 20, 180);

      doc.save("certificate.pdf");
    }
  </script>
</body>
</html>
